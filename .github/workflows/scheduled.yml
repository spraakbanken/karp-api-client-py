# Code generated by internal/ci/github/ci_tool.cue; DO NOT EDIT.

permissions:
  contents: read
"on":
  push:
    branches:
      - main
  pull_request: null
  schedule:
    - cron: 7 7 * * *
concurrency:
  group: ${{ github.workflow }}-${{ github.head_ref || github.run_id }}
  cancel-in-progress: true
name: rolling
env:
  UV_VERSION: 0.5.15
jobs:
  nightly:
    runs-on: ubuntu-latest
    name: ubuntu / 3.14-dev
    steps:
      - uses: actions/checkout@v4
        with:
          submodules: true
      - name: Set up uv
        uses: astral-sh/setup-uv@v5
        with:
          version: ${{ env.UV_VERSION }}
          enable-cache: true
      - name: Install python
        uses: actions/setup-python@v5
        with:
          python-version: 3.14-dev
      - run: python --version
      - name: uv lock
        if: hashFiles('uv.lock') == ''
        run: uv lock
      - name: uv sync --dev
        run: uv sync --dev --all-packages --all-extras
      - name: make test
        run: make test
  update:
    runs-on: ubuntu-latest
    name: ubuntu / 3.12 / updates work
    steps:
      - uses: actions/checkout@v4
        with:
          submodules: true
      - name: Set up uv
        if: hashFiles('uv.lock') != ''
        uses: astral-sh/setup-uv@v5
        with:
          version: ${{ env.UV_VERSION }}
          enable-cache: true
      - name: Install 3.12
        if: hashFiles('uv.lock') != ''
        uses: actions/setup-python@v5
        with:
          python-version: "3.12"
      - name: uv sync --dev --upgrade
        if: hashFiles('uv.lock') != ''
        run: uv sync --dev --upgrade --all-packages --all-extras
      - name: make test
        if: hashFiles('uv.lock') != ''
        run: make test
